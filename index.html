<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BaintWallet - Premium Multi-Chain Wallet</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap');
        
        * {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body { 
            margin: 0; 
            padding: 0;
            overflow-x: hidden;
        }
        
        #root { 
            min-height: 100vh; 
        }
        
        @keyframes meshGradient {
            0%, 100% { background-position: 0% 0%, 100% 100%, 50% 50%; }
            33% { background-position: 100% 0%, 0% 100%, 25% 75%; }
            66% { background-position: 50% 100%, 50% 0%, 75% 25%; }
        }
        
        .animated-gradient {
            background: 
                radial-gradient(at 0% 0%, #667eea 0px, transparent 50%),
                radial-gradient(at 100% 100%, #764ba2 0px, transparent 50%),
                radial-gradient(at 50% 50%, #f093fb 0px, transparent 50%),
                radial-gradient(at 100% 0%, #4facfe 0px, transparent 50%),
                linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            background-size: 200% 200%, 200% 200%, 200% 200%, 200% 200%, 100% 100%;
            animation: meshGradient 20s ease infinite;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(30px);
            border: 2px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        
        .dark .glass-card {
            background: rgba(15, 15, 35, 0.95);
            border: 2px solid rgba(139, 92, 246, 0.3);
            box-shadow: 0 8px 32px 0 rgba(139, 92, 246, 0.2);
        }
        
        .dark { color: #f5f5f5; }
        .dark .bg-gray-50 { background: rgba(30, 30, 50, 0.6) !important; }
        .dark .bg-gray-100 { background: rgba(25, 25, 45, 0.8) !important; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes spin { to { transform: rotate(360deg); } }
        
        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .fade-in { animation: fadeIn 0.8s ease; }
        .float-animation { animation: float 4s ease-in-out infinite; }
        .spinner { animation: spin 1s linear infinite; }
        
        .hover-lift {
            transition: all 0.3s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(139, 92, 246, 0.3);
        }
        
        .hover-glow:hover {
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.6);
            transform: scale(1.05);
        }
        
        .premium-button {
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s;
        }
        
        .premium-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }
        
        .premium-button:hover::before { left: 100%; }
        
        .gradient-text {
            background: linear-gradient(135deg, #667eea, #764ba2, #f093fb, #4facfe);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientFlow 5s ease infinite;
        }
        
        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s;
        }
        
        .dot-active {
            width: 32px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.9);
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        function App() {
          const [wallet, setWallet] = useState(null);
          const [loading, setLoading] = useState(false);
          const [message, setMessage] = useState('');
          const [seedInput, setSeedInput] = useState('');
          const [view, setView] = useState('intro');
          const [introStep, setIntroStep] = useState(0);
          const [sendTo, setSendTo] = useState('');
          const [sendAmount, setSendAmount] = useState('');
          const [isTestnet, setIsTestnet] = useState(true);
          const [chain, setChain] = useState('ETH');
          const [txs, setTxs] = useState([]);
          const [showSeed, setShowSeed] = useState(false);
          const [tokens, setTokens] = useState([]);
          const [loadingTokens, setLoadingTokens] = useState(false);
          const [selectedToken, setSelectedToken] = useState(null);
          const [sendTokenAmount, setSendTokenAmount] = useState('');
          const [prices, setPrices] = useState({});
          const [darkMode, setDarkMode] = useState(false);
          const [countingBalance, setCountingBalance] = useState(0);
          const [priceCache, setPriceCache] = useState({ data: null, timestamp: 0 });
          const [wcUri, setWcUri] = useState('');
          const [wcConnected, setWcConnected] = useState(false);
          const [dappUrl, setDappUrl] = useState('https://app.uniswap.org');
          const [showDappBrowser, setShowDappBrowser] = useState(false);
          const [rpcAttempts, setRpcAttempts] = useState({});
          const [nfts, setNfts] = useState([]);
          const [loadingNFTs, setLoadingNFTs] = useState(false);
          const [selectedNFT, setSelectedNFT] = useState(null);
          const [notifications, setNotifications] = useState([]);
          const [showNotifications, setShowNotifications] = useState(false);
          const [customNetworks, setCustomNetworks] = useState([]);
          const [showAddNetwork, setShowAddNetwork] = useState(false);
          const [newNetwork, setNewNetwork] = useState({ name: '', rpc: '', chainId: '', symbol: '', explorer: '' });
          const [referralCode, setReferralCode] = useState('');
          const [referralStats, setReferralStats] = useState({ referrals: 0, earnings: 0 });
          const [userId, setUserId] = useState('');
          const qrRef = useRef(null);

          const PLATFORM_WALLET = '0x88bf316109c1d462e5ec18a204d6f0537f6fae1c';
          const NFT_TRANSFER_FEE = 0.50; // $0.50 in USD
          const BACKEND_API = 'http://localhost:3000/api'; // Update with your server URL

          // ALL 15 CHAINS - COMPLETE LIST
          const chains = {
            ETH: {
              name: 'Ethereum', symbol: 'ETH', icon: '‚ü†', color: 'from-blue-500 to-purple-600',
              testnet: { 
                rpc: [
                  'https://sepolia.infura.io/v3/2eb003d772d345c48214cad05878e67c',
                  'https://eth-sepolia.g.alchemy.com/v2/RV7R38aklgHvDsNjslY6Xo9ptfJ--r2t',
                  'https://ethereum-sepolia-rpc.publicnode.com'
                ],
                explorer: 'https://sepolia.etherscan.io', 
                chainId: 11155111 
              },
              mainnet: { 
                rpc: [
                  'https://mainnet.infura.io/v3/2eb003d772d345c48214cad05878e67c',
                  'https://eth-mainnet.g.alchemy.com/v2/RV7R38aklgHvDsNjslY6Xo9ptfJ--r2t',
                  'https://ethereum-rpc.publicnode.com'
                ],
                explorer: 'https://etherscan.io', 
                chainId: 1 
              }
            },
            BNB: {
              name: 'BNB Chain', symbol: 'BNB', icon: '‚óÜ', color: 'from-yellow-400 to-orange-500',
              testnet: { 
                rpc: ['https://bsc-testnet-rpc.publicnode.com'],
                explorer: 'https://testnet.bscscan.com', 
                chainId: 97 
              },
              mainnet: { 
                rpc: ['https://bsc-rpc.publicnode.com', 'https://bsc-dataseed1.binance.org'],
                explorer: 'https://bscscan.com', 
                chainId: 56 
              }
            },
            POLYGON: {
              name: 'Polygon', symbol: 'MATIC', icon: '‚¨°', color: 'from-purple-500 to-purple-700',
              testnet: { 
                rpc: ['https://rpc-amoy.polygon.technology'],
                explorer: 'https://amoy.polygonscan.com', 
                chainId: 80002 
              },
              mainnet: { 
                rpc: ['https://polygon-rpc.com', 'https://polygon.llamarpc.com'],
                explorer: 'https://polygonscan.com', 
                chainId: 137 
              }
            },
            AVAX: {
              name: 'Avalanche', symbol: 'AVAX', icon: '‚ñ≤', color: 'from-red-500 to-pink-600',
              testnet: { 
                rpc: ['https://api.avax-test.network/ext/bc/C/rpc'],
                explorer: 'https://testnet.snowtrace.io', 
                chainId: 43113 
              },
              mainnet: { 
                rpc: ['https://api.avax.network/ext/bc/C/rpc', 'https://avalanche.public-rpc.com'],
                explorer: 'https://snowtrace.io', 
                chainId: 43114 
              }
            },
            ARBITRUM: {
              name: 'Arbitrum', symbol: 'ETH', icon: '‚óä', color: 'from-blue-400 to-cyan-500',
              testnet: { 
                rpc: ['https://sepolia-rollup.arbitrum.io/rpc'],
                explorer: 'https://sepolia.arbiscan.io', 
                chainId: 421614 
              },
              mainnet: { 
                rpc: ['https://arb1.arbitrum.io/rpc', 'https://arbitrum.llamarpc.com'],
                explorer: 'https://arbiscan.io', 
                chainId: 42161 
              }
            },
            OPTIMISM: {
              name: 'Optimism', symbol: 'ETH', icon: '‚óâ', color: 'from-red-400 to-pink-500',
              testnet: { 
                rpc: ['https://sepolia.optimism.io'],
                explorer: 'https://sepolia-optimism.etherscan.io', 
                chainId: 11155420 
              },
              mainnet: { 
                rpc: ['https://mainnet.optimism.io', 'https://optimism.llamarpc.com'],
                explorer: 'https://optimistic.etherscan.io', 
                chainId: 10 
              }
            },
            BASE: {
              name: 'Base', symbol: 'ETH', icon: '‚ö°', color: 'from-blue-600 to-indigo-700',
              testnet: { 
                rpc: ['https://sepolia.base.org'],
                explorer: 'https://sepolia.basescan.org', 
                chainId: 84532 
              },
              mainnet: { 
                rpc: ['https://mainnet.base.org', 'https://base.llamarpc.com'],
                explorer: 'https://basescan.org', 
                chainId: 8453 
              }
            },
            ARC: {
              name: 'Circle Arc', symbol: 'USDC', icon: 'üîµ', color: 'from-blue-400 to-cyan-600',
              testnet: { 
                rpc: [
                  'https://rpc.testnet.arc.network',
                  'https://rpc.blockdaemon.testnet.arc.network',
                  'https://rpc.drpc.testnet.arc.network'
                ],
                explorer: 'https://testnet.arcscan.app', 
                chainId: 5042002
              },
              mainnet: { 
                rpc: ['https://arc-mainnet.rpc.caldera.xyz/http'],
                explorer: 'https://arc.explorer.caldera.xyz',
                chainId: 41453
              }
            },
            FANTOM: {
              name: 'Fantom', symbol: 'FTM', icon: 'üëª', color: 'from-blue-500 to-indigo-600',
              testnet: { 
                rpc: ['https://rpc.testnet.fantom.network'],
                explorer: 'https://testnet.ftmscan.com', 
                chainId: 4002 
              },
              mainnet: { 
                rpc: ['https://rpc.ftm.tools', 'https://fantom.publicnode.com'],
                explorer: 'https://ftmscan.com', 
                chainId: 250 
              }
            },
            ZKSYNC: {
              name: 'zkSync Era', symbol: 'ETH', icon: '‚öîÔ∏è', color: 'from-purple-600 to-blue-600',
              testnet: { 
                rpc: ['https://sepolia.era.zksync.dev'],
                explorer: 'https://sepolia.explorer.zksync.io', 
                chainId: 300 
              },
              mainnet: { 
                rpc: ['https://mainnet.era.zksync.io'],
                explorer: 'https://explorer.zksync.io', 
                chainId: 324 
              }
            },
            SCROLL: {
              name: 'Scroll', symbol: 'ETH', icon: 'üìú', color: 'from-orange-400 to-red-500',
              testnet: { 
                rpc: ['https://sepolia-rpc.scroll.io'],
                explorer: 'https://sepolia.scrollscan.com', 
                chainId: 534351 
              },
              mainnet: { 
                rpc: ['https://rpc.scroll.io'],
                explorer: 'https://scrollscan.com', 
                chainId: 534352 
              }
            },
            MANTLE: {
              name: 'Mantle', symbol: 'MNT', icon: 'üß©', color: 'from-gray-800 to-black',
              testnet: { 
                rpc: ['https://rpc.sepolia.mantle.xyz'],
                explorer: 'https://sepolia.mantlescan.xyz', 
                chainId: 5003 
              },
              mainnet: { 
                rpc: ['https://rpc.mantle.xyz'],
                explorer: 'https://mantlescan.xyz', 
                chainId: 5000 
              }
            },
            LINEA: {
              name: 'Linea', symbol: 'ETH', icon: 'üìê', color: 'from-gray-700 to-gray-900',
              testnet: { 
                rpc: ['https://rpc.goerli.linea.build'],
                explorer: 'https://goerli.lineascan.build', 
                chainId: 59140 
              },
              mainnet: { 
                rpc: ['https://rpc.linea.build'],
                explorer: 'https://lineascan.build', 
                chainId: 59144 
              }
            },
            HYPERLIQUID: {
              name: 'Hyperliquid', symbol: 'ETH', icon: 'üíß', color: 'from-cyan-500 to-blue-600',
              testnet: { 
                rpc: ['https://api.hyperliquid-testnet.xyz/evm'],
                explorer: 'https://explorer.hyperliquid-testnet.xyz', 
                chainId: 998 
              },
              mainnet: { 
                rpc: ['https://api.hyperliquid.xyz/evm'],
                explorer: 'https://explorer.hyperliquid.xyz', 
                chainId: 999 
              }
            },
            APECHAIN: {
              name: 'ApeChain', symbol: 'APE', icon: 'ü¶ç', color: 'from-blue-600 to-indigo-700',
              testnet: { 
                rpc: ['https://curtis.rpc.caldera.xyz/http'],
                explorer: 'https://curtis.explorer.caldera.xyz', 
                chainId: 33111 
              },
              mainnet: { 
                rpc: ['https://apechain.caldera.dev/http', 'https://rpc.apechain.com'],
                explorer: 'https://apechain.calderaexplorer.xyz', 
                chainId: 33139 
              }
            }
          };

          const TOKEN_ADDRESSES = {
            ETH: { 
              USDT: '0xdAC17F958D2ee523a2206206994597C13D831ec7', 
              USDC: '0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48'
            },
            BNB: { 
              USDT: '0x55d398326f99059fF775485246999027B3197955', 
              USDC: '0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d' 
            },
            POLYGON: { 
              USDT: '0xc2132D05D31c914a87C6611C10748AEb04B58e8F', 
              USDC: '0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174' 
            }
          };

          const ERC20_ABI = [
            "function balanceOf(address) view returns (uint256)", 
            "function decimals() view returns (uint8)", 
            "function symbol() view returns (string)", 
            "function transfer(address to, uint256 amount) returns (bool)", 
            "function name() view returns (string)"
          ];

          const ERC721_ABI = [
            "function balanceOf(address owner) view returns (uint256)",
            "function tokenOfOwnerByIndex(address owner, uint256 index) view returns (uint256)",
            "function tokenURI(uint256 tokenId) view returns (string)",
            "function transferFrom(address from, address to, uint256 tokenId)",
            "function ownerOf(uint256 tokenId) view returns (address)"
          ];

          const introSlides = [
            { icon: 'üåü', title: 'Welcome to BaintWallet', description: 'The most advanced crypto wallet with 15+ blockchain support including Circle Arc, Hyperliquid & ApeChain.', gradient: 'from-blue-500 to-purple-600' },
            { icon: 'üîê', title: 'Your Keys, Your Crypto', description: 'Military-grade encryption. We never store your private keys.', gradient: 'from-purple-500 to-pink-600' },
            { icon: '‚ö°', title: 'Multi-Chain Support', description: 'Manage assets across Ethereum, BNB, Polygon, Arbitrum, Base, Circle Arc, Hyperliquid, ApeChain and more.', gradient: 'from-yellow-400 to-orange-500' },
            { icon: 'üíé', title: 'Premium Experience', description: 'WalletConnect, DApp Browser, NFTs, referrals, real-time prices. Ready for Web3.', gradient: 'from-indigo-500 to-purple-600' }
          ];

          // Initialize user ID and referral code
          useEffect(() => {
            let uid = localStorage.getItem('baintwallet_user_id');
            if (!uid) {
              uid = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
              localStorage.setItem('baintwallet_user_id', uid);
            }
            setUserId(uid);

            // Check for referral code in URL
            const urlParams = new URLSearchParams(window.location.search);
            const refCode = urlParams.get('ref');
            if (refCode) {
              localStorage.setItem('referred_by', refCode);
              addNotification('üéÅ', 'Referral Applied!', `You've been referred by ${refCode}. Enjoy benefits!`);
            }

            // Generate user's own referral code
            const myRefCode = 'BAINT-' + uid.slice(-6).toUpperCase();
            setReferralCode(myRefCode);

            // Load custom networks
            const savedNetworks = localStorage.getItem('custom_networks');
            if (savedNetworks) {
              setCustomNetworks(JSON.parse(savedNetworks));
            }

           
            // Notifications disabled for compatibility
console.log('Notifications disabled for mobile compatibility');
            }
          }, []);

          const celebrate = () => { confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } }); };
          const showMsg = (msg) => { setMessage(msg); setTimeout(() => setMessage(''), 4000); };
          
          const addNotification = (icon, title, message) => {
  const notif = {
    id: Date.now(),
    icon,
    title,
    message,
    time: new Date().toLocaleTimeString(),
    read: false
  };
  setNotifications(prev => [notif, ...prev.slice(0, 9)]);

  // Safe browser notification
  if (typeof Notification !== 'undefined') {
    if (Notification.permission === 'granted') {
      try {
        const n = new Notification(title, {
          body: message,
          tag: 'bw-' + Date.now()
        });
        setTimeout(() => { try { n.close(); } catch(e) {} }, 5000);
      } catch (e) {
        // Silently fail - notifications not critical
        console.log('Notification blocked');
      }
    }
  }
};

// FIXED CODE:
if ('Notification' in window) {
  if (Notification.permission === 'granted') {
    try {
      new Notification(title, {
        body: message,
        icon: '/logo.png',
        tag: 'baintwallet-' + Date.now()
      });
    } catch (e) {
      console.log('Notification blocked:', e);
    }
  } else if (Notification.permission !== 'denied') {
    Notification.requestPermission().then(permission => {
      if (permission === 'granted') {
        try {
          new Notification(title, {
            body: message,
            icon: '/logo.png',
            tag: 'baintwallet-' + Date.now()
          });
        } catch (e) {
          console.log('Notification blocked:', e);
        }
      }
    });
  }
}
          const trackEvent = async (eventName, data = {}) => {
            try {
              await fetch(`${BACKEND_API}/track`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                  userId,
                  event: eventName,
                  timestamp: new Date().toISOString(),
                  data,
                  referredBy: localStorage.getItem('referred_by')
                })
              });
            } catch (e) {
              console.error('Analytics error:', e);
            }
          };

          const getProviderWithRetry = async (maxRetries = 3) => {
            const c = chains[chain];
            const rpcList = isTestnet ? c.testnet.rpc : c.mainnet.rpc;
            const rpcArray = Array.isArray(rpcList) ? rpcList : [rpcList];
            
            for (let i = 0; i < Math.min(maxRetries, rpcArray.length); i++) {
              try {
                const rpc = rpcArray[i];
                const provider = new ethers.providers.JsonRpcProvider(rpc);
                await provider.getNetwork();
                console.log(`‚úÖ Connected to ${chain} using RPC ${i + 1}`);
                return provider;
              } catch (e) {
                console.error(`‚ùå RPC ${i + 1} failed:`, e.message);
                if (i === Math.min(maxRetries, rpcArray.length) - 1) {
                  throw new Error(`All RPCs failed for ${chain}`);
                }
              }
            }
          };
          
          const getExplorer = () => { 
            const c = chains[chain]; 
            return isTestnet ? c.testnet.explorer : c.mainnet.explorer; 
          };

          useEffect(() => {
            if (wallet && wallet.balance) {
              const target = parseFloat(wallet.balance);
              const duration = 1000;
              const steps = 30;
              const increment = target / steps;
              let current = 0;
              const timer = setInterval(() => {
                current += increment;
                if (current >= target) { 
                  setCountingBalance(target); 
                  clearInterval(timer); 
                } else { 
                  setCountingBalance(current); 
                }
              }, duration / steps);
              return () => clearInterval(timer);
            }
          }, [wallet?.balance]);

          const fetchPrices = async (forceRefresh = false) => {
            const now = Date.now();
            const CACHE_DURATION = 60000;

            if (!forceRefresh && priceCache.data && (now - priceCache.timestamp) < CACHE_DURATION) {
              setPrices(priceCache.data);
              return;
            }

            try {
              const response = await fetch(
                'https://api.coingecko.com/api/v3/simple/price?ids=ethereum,binancecoin,matic-network,avalanche-2,fantom,mantle&vs_currencies=usd'
              );
              
              if (!response.ok) throw new Error('Price API failed');
              
              const data = await response.json();
              
              const newPrices = { 
                ETH: data.ethereum?.usd || 2500,
                BNB: data.binancecoin?.usd || 300,
                MATIC: data['matic-network']?.usd || 0.8,
                AVAX: data['avalanche-2']?.usd || 25,
                FTM: data.fantom?.usd || 0.4,
                MNT: data.mantle?.usd || 0.8,
                USDC: 1.0,
                APE: 1.2
              };
              
              setPriceCache({ data: newPrices, timestamp: now });
              setPrices(newPrices);
              
            } catch (e) { 
              console.error('Price fetch error:', e);
              setPrices({ ETH: 2500, BNB: 300, MATIC: 0.8, AVAX: 25, FTM: 0.4, MNT: 0.8, USDC: 1.0, APE: 1.2 });
            }
          };

          const createWallet = async () => {
            setLoading(true);
            try {
              const w = ethers.Wallet.createRandom();
              const provider = await getProviderWithRetry();
              const balance = await provider.getBalance(w.address);
              
              setWallet({ 
                address: w.address,privateKey: w.privateKey, 
                mnemonic: w.mnemonic.phrase, 
                balance: ethers.utils.formatEther(balance) 
              });
              
              showMsg('‚úÖ Wallet created successfully!');
              celebrate();
              addNotification('‚ú®', 'Wallet Created', 'Your new wallet is ready!');
              trackEvent('wallet_created', { chain, isTestnet });
              setView('wallet');
              fetchPrices();
            } catch (e) { 
              console.error('Create wallet error:', e);
              showMsg('‚ùå Error: ' + e.message);
            }
            setLoading(false);
          const importWallet = async () => {
  if (!seedInput.trim()) { 
    showMsg('‚ùå Please enter your seed phrase'); 
    return; 
  }
  
  setLoading(true);
  
  try {
    // Clean the seed phrase
    const cleanSeed = seedInput
      .trim()
      .toLowerCase()
      .replace(/\s+/g, ' ')
      .replace(/[^\w\s]/g, '');
    
    const words = cleanSeed.split(' ');
    
    // Validate word count
    if (words.length !== 12 && words.length !== 24) {
      showMsg(`‚ùå Invalid seed phrase length: ${words.length} words. Must be 12 or 24 words.`);
      setLoading(false);
      return;
    }
    
    // Try to import wallet
    let w;
    try {
      w = ethers.Wallet.fromMnemonic(cleanSeed);
    } catch (err) {
      console.error('Mnemonic validation error:', err);
      showMsg('‚ùå Invalid seed phrase. Please verify:');
      setTimeout(() => showMsg('‚Ä¢ Correct spelling of all words'), 1500);
      setTimeout(() => showMsg('‚Ä¢ Correct word order'), 3000);
      setTimeout(() => showMsg('‚Ä¢ No extra spaces or characters'), 4500);
      setLoading(false);
      return;
    }
    
    // Connect to network
    try {
      const provider = await getProviderWithRetry();
      const balance = await provider.getBalance(w.address);
      
      setWallet({ 
        address: w.address, 
        privateKey: w.privateKey, 
        mnemonic: w.mnemonic.phrase, 
        balance: ethers.utils.formatEther(balance) 
      });
      
      showMsg('‚úÖ Wallet imported successfully!');
      celebrate();
      addNotification('üì•', 'Success!', 'Wallet imported and ready to use');
      trackEvent('wallet_imported', { chain, isTestnet });
      setSeedInput('');
      setView('wallet');
      fetchPrices();
    } catch (networkErr) {
      console.error('Network error:', networkErr);
      showMsg('‚ö†Ô∏è Wallet imported but network error. Try switching chains.');
      
      // Still set the wallet even if network fails
      setWallet({ 
        address: w.address, 
        privateKey: w.privateKey, 
        mnemonic: w.mnemonic.phrase, 
        balance: '0.0'
      });
      
      setSeedInput('');
      setView('wallet');
    }
    
  } catch (e) {
    console.error('Unexpected import error:', e);
    showMsg('‚ùå Failed to import wallet. Please try again.');
  }
  
  setLoading(false);
};};

          

          const refreshBalance = async () => {
            if (!wallet) return;
            setLoading(true);
            try {
              const provider = await getProviderWithRetry();
              const balance = await provider.getBalance(wallet.address);
              setWallet({...wallet, balance: ethers.utils.formatEther(balance)});
              fetchPrices(true);
              
              if (!isTestnet) { 
                loadTokenBalances(); 
              }
              
              showMsg('‚úÖ Balance refreshed!');
              celebrate();
            } catch (e) { 
              console.error('Refresh error:', e);
              showMsg('‚ö†Ô∏è Network error. Try switching RPC or chain.');
            }
            setLoading(false);
          };

          const send = async () => {
            if (!sendTo || !sendAmount) { 
              showMsg('‚ùå Enter address and amount'); 
              return; 
            }
            
            if (!ethers.utils.isAddress(sendTo)) { 
              showMsg('‚ùå Invalid address'); 
              return; 
            }
            
            setLoading(true);
            try {
              const provider = await getProviderWithRetry();
              const signer = new ethers.Wallet(wallet.privateKey, provider);
              const tx = await signer.sendTransaction({ 
                to: sendTo, 
                value: ethers.utils.parseEther(sendAmount) 
              });
              
              showMsg('‚úÖ Transaction sent! (FREE - No Platform Fee)');
              celebrate();
              addNotification('üì§', 'Transaction Sent', `${sendAmount} ${chains[chain].symbol} sent successfully`);
              
              trackEvent('transaction_sent', {
                chain,
                amount: sendAmount,
                symbol: chains[chain].symbol,
                fee: 0,
                txHash: tx.hash
              });
              
              setTxs([{ 
                hash: tx.hash, 
                to: sendTo, 
                amount: sendAmount, 
                time: new Date().toLocaleString(), 
                status: 'pending', 
                type: 'send', 
                chain: chain, 
                symbol: chains[chain].symbol 
              }, ...txs]);
              
              tx.wait().then(() => { 
                setTxs(prev => prev.map(t => t.hash === tx.hash ? {...t, status: 'confirmed'} : t)); 
                showMsg('‚úÖ Confirmed!'); 
                celebrate();
                addNotification('‚úÖ', 'Transaction Confirmed', `${sendAmount} ${chains[chain].symbol} confirmed on blockchain`);
                refreshBalance(); 
              });
              
              setSendTo(''); 
              setSendAmount(''); 
              setView('wallet');
            } catch (e) { 
              console.error('Send error:', e);
              showMsg('‚ùå ' + (e.reason || e.message)); 
            }
            setLoading(false);
          };

          const loadTokenBalances = async () => {
            if (!wallet || isTestnet) return;
            
            setLoadingTokens(true);
            const tokenAddresses = TOKEN_ADDRESSES[chain] || {};
            const tokenList = [];
            
            try {
              const provider = await getProviderWithRetry();
              
              for (const [symbol, address] of Object.entries(tokenAddresses)) {
                try {
                  const contract = new ethers.Contract(address, ERC20_ABI, provider);
                  
                  const [balance, decimals, name] = await Promise.all([
                    contract.balanceOf(wallet.address), 
                    contract.decimals(), 
                    contract.name()
                  ]);
                  
                  const formattedBalance = ethers.utils.formatUnits(balance, decimals);
                  
                  if (parseFloat(formattedBalance) > 0) { 
                    tokenList.push({ 
                      symbol, 
                      name, 
                      address,
                      balance: formattedBalance, 
                      decimals 
                    }); 
                  }
                } catch (e) { 
                  console.error(`Error loading ${symbol}:`, e.message); 
                }
              }
              
              setTokens(tokenList);
            } catch (e) { 
              console.error('Token loading error:', e);
              showMsg('‚ö†Ô∏è Could not load tokens');
            }
            
            setLoadingTokens(false);
          };

          const sendToken = async () => {
            if (!selectedToken || !sendTo || !sendTokenAmount) { 
              showMsg('‚ùå Fill all fields'); 
              return; 
            }
            
            if (!ethers.utils.isAddress(sendTo)) { 
              showMsg('‚ùå Invalid address'); 
              return; 
            }
            
            setLoading(true);
            try {
              const provider = await getProviderWithRetry();
              const signer = new ethers.Wallet(wallet.privateKey, provider);
              const contract = new ethers.Contract(selectedToken.address, ERC20_ABI, signer);
              const amount = ethers.utils.parseUnits(sendTokenAmount, selectedToken.decimals);
              const tx = await contract.transfer(sendTo, amount);
              
              showMsg(`‚úÖ ${selectedToken.symbol} sent! (FREE)`);
              celebrate();
              addNotification('ü™ô', 'Token Sent', `${sendTokenAmount} ${selectedToken.symbol} sent successfully`);
              
              trackEvent('token_sent', {
                chain,
                token: selectedToken.symbol,
                amount: sendTokenAmount,
                txHash: tx.hash
              });
              
              setTxs([{ 
                hash: tx.hash, 
                to: sendTo, 
                amount: sendTokenAmount, 
                time: new Date().toLocaleString(), 
                status: 'pending', 
                type: 'token-send', 
                chain: chain, 
                symbol: selectedToken.symbol 
              }, ...txs]);
              
              tx.wait().then(() => { 
                setTxs(prev => prev.map(t => t.hash === tx.hash ? {...t, status: 'confirmed'} : t)); 
                showMsg('‚úÖ Confirmed!'); 
                celebrate();
                addNotification('‚úÖ', 'Token Transfer Confirmed', `${sendTokenAmount} ${selectedToken.symbol} confirmed`);
                loadTokenBalances(); 
              });
              
              setSendTo(''); 
              setSendTokenAmount(''); 
              setSelectedToken(null); 
              setView('wallet');
            } catch (e) { 
              console.error('Token send error:', e);
              showMsg('‚ùå ' + (e.reason || e.message)); 
            }
            setLoading(false);
          };

          // NFT Functions
          const loadNFTs = async () => {
            if (!wallet || isTestnet) {
              showMsg('‚ö†Ô∏è NFTs only available on mainnet');
              return;
            }
            
            setLoadingNFTs(true);
            try {
              // Using Alchemy NFT API
              const alchemyKey = 'RV7R38aklgHvDsNjslY6Xo9ptfJ--r2t';
              let baseURL = '';
              
              if (chain === 'ETH') {
                baseURL = `https://eth-mainnet.g.alchemy.com/v2/${alchemyKey}`;
              } else if (chain === 'POLYGON') {
                baseURL = `https://polygon-mainnet.g.alchemy.com/v2/${alchemyKey}`;
              } else {
                showMsg('‚ö†Ô∏è NFTs only supported on ETH and Polygon');
                setLoadingNFTs(false);
                return;
              }
              
              const response = await fetch(
                `${baseURL}/getNFTs/?owner=${wallet.address}&withMetadata=true`
              );
              
              const data = await response.json();
              
              const nftList = data.ownedNfts.map(nft => ({
                contract: nft.contract.address,
                tokenId: nft.id.tokenId,
                name: nft.title || `NFT #${nft.id.tokenId}`,
                description: nft.description || '',
                image: nft.media[0]?.gateway || nft.metadata?.image || '',
                collection: nft.contract.name || 'Unknown Collection'
              }));
              
              setNfts(nftList);
              addNotification('üñºÔ∏è', 'NFTs Loaded', `Found ${nftList.length} NFTs`);
            } catch (e) {
              console.error('NFT loading error:', e);
              showMsg('‚ö†Ô∏è Could not load NFTs');
            }
            setLoadingNFTs(false);
          };

          const sendNFT = async (nft, toAddress) => {
            if (!toAddress || !ethers.utils.isAddress(toAddress)) {
              showMsg('‚ùå Invalid recipient address');
              return;
            }
            
            setLoading(true);
            try {
              const provider = await getProviderWithRetry();
              const signer = new ethers.Wallet(wallet.privateKey, provider);
              
              // Calculate fee in native token
              const priceInUSD = prices[chains[chain].symbol] || 2500;
              const feeInToken = NFT_TRANSFER_FEE / priceInUSD;
              const feeInWei = ethers.utils.parseEther(feeInToken.toFixed(18));
              
              // Send platform fee
              const feeTx = await signer.sendTransaction({
                to: PLATFORM_WALLET,
                value: feeInWei
              });
              
              await feeTx.wait();
              
              // Transfer NFT
              const contract = new ethers.Contract(nft.contract, ERC721_ABI, signer);
              const tx = await contract.transferFrom(wallet.address, toAddress, nft.tokenId);
              
              showMsg(`‚úÖ NFT sent! Platform fee: $${NFT_TRANSFER_FEE}`);
              celebrate();
              addNotification('üñºÔ∏è', 'NFT Transferred', `${nft.name} sent successfully`);
              
              trackEvent('nft_sent', {
                chain,
                nftName: nft.name,
                collection: nft.collection,
                fee: NFT_TRANSFER_FEE,
                txHash: tx.hash
              });
              
              await tx.wait();
              showMsg('‚úÖ NFT transfer confirmed!');
              celebrate();
              loadNFTs();
              setSelectedNFT(null);
              setView('nfts');
            } catch (e) {
              console.error('NFT send error:', e);
              showMsg('‚ùå ' + (e.reason || e.message));
            }
            setLoading(false);
          };

          // Custom Network Functions
          const addCustomNetwork = async () => {
            if (!newNetwork.name || !newNetwork.rpc || !newNetwork.chainId || !newNetwork.symbol) {
              showMsg('‚ùå Fill all required fields');
              return;
            }
            
            setLoading(true);
            try {
              // Validate network
              const provider = new ethers.providers.JsonRpcProvider(newNetwork.rpc);
              const network = await provider.getNetwork();
              
              if (network.chainId !== parseInt(newNetwork.chainId)) {
                showMsg('‚ùå Chain ID mismatch! Verify your RPC and Chain ID.');
                setLoading(false);
                return;
              }
              
              const customNet = {
                id: 'CUSTOM_' + Date.now(),
                name: newNetwork.name,
                symbol: newNetwork.symbol,
                icon: 'üîó',
                color: 'from-gray-500 to-gray-700',
                testnet: { rpc: [newNetwork.rpc], explorer: newNetwork.explorer || '', chainId: parseInt(newNetwork.chainId) },
                mainnet: { rpc: [newNetwork.rpc], explorer: newNetwork.explorer || '', chainId: parseInt(newNetwork.chainId) },
                isCustom: true
              };
              
              const updated = [...customNetworks, customNet];
              setCustomNetworks(updated);
              localStorage.setItem('custom_networks', JSON.stringify(updated));
              
              showMsg('‚úÖ Custom network added! (FREE)');
              celebrate();
              addNotification('üåê', 'Network Added', `${newNetwork.name} is now available`);
              trackEvent('custom_network_added', { networkName: newNetwork.name });
              
              setNewNetwork({ name: '', rpc: '', chainId: '', symbol: '', explorer: '' });
              setShowAddNetwork(false);
            } catch (e) {
              console.error('Add network error:', e);
              showMsg('‚ùå Invalid network. Check RPC and Chain ID.');
            }
            setLoading(false);
          };

          const removeCustomNetwork = (networkId) => {
            const updated = customNetworks.filter(n => n.id !== networkId);
            setCustomNetworks(updated);
            localStorage.setItem('custom_networks', JSON.stringify(updated));
            showMsg('‚úÖ Network removed');
          };

          // Receipt Generation
          const generateReceipt = (transaction) => {
            try {
              const { jsPDF } = window.jspdf;
              const doc = new jsPDF();
              
              // Header
              doc.setFontSize(24);
              doc.setTextColor(102, 126, 234);
              doc.text('BaintWallet', 20, 30);
              
              doc.setFontSize(18);
              doc.setTextColor(0, 0, 0);
              doc.text('Transaction Receipt', 20, 45);
              
              // Details
              doc.setFontSize(12);
              doc.text(`Transaction Hash:`, 20, 65);
              doc.setFontSize(10);
              doc.text(transaction.hash, 20, 72);
              
              doc.setFontSize(12);
              doc.text(`From:`, 20, 85);
              doc.setFontSize(10);
              doc.text(wallet.address, 20, 92);
              
              doc.setFontSize(12);
              doc.text(`To:`, 20, 105);
              doc.setFontSize(10);
              doc.text(transaction.to, 20, 112);
              
              doc.setFontSize(12);
              doc.text(`Amount: ${transaction.amount} ${transaction.symbol}`, 20, 125);
              doc.text(`Chain: ${chains[transaction.chain].name}`, 20, 135);
              doc.text(`Status: ${transaction.status}`, 20, 145);
              doc.text(`Date: ${transaction.time}`, 20, 155);
              doc.text(`Platform Fee: FREE`, 20, 165);
              
              // Footer
              doc.setFontSize(10);
              doc.setTextColor(128, 128, 128);
              doc.text('Generated by BaintWallet - Your keys, your crypto', 20, 280);
              
              doc.save(`receipt-${transaction.hash.slice(0, 10)}.pdf`);
              showMsg('‚úÖ Receipt downloaded!');
              celebrate();
            } catch (e) {
              console.error('Receipt generation error:', e);
              showMsg('‚ùå Could not generate receipt');
            }
          };

          const connectWalletConnect = () => {
            if (!wcUri.trim()) {
              showMsg('‚ùå Enter WalletConnect URI');
              return;
            }
            
            setWcConnected(true);
            showMsg('‚úÖ WalletConnect session started!');
            celebrate();
            addNotification('üîó', 'WalletConnect', 'Connected to DApp');
          };

          const disconnectWalletConnect = () => {
            setWcConnected(false);
            setWcUri('');
            showMsg('‚úÖ Disconnected');
            addNotification('üîå', 'WalletConnect', 'Disconnected from DApp');
          };

          useEffect(() => {
            if (view === 'receive' && qrRef.current && wallet) {
              qrRef.current.innerHTML = '';
              new QRCode(qrRef.current, { 
                text: wallet.address, 
                width: 200, 
                height: 200, 
                colorDark: darkMode ? "#ffffff" : "#000000", 
                colorLight: darkMode ? "#1e1e2e" : "#ffffff" 
              });
            }
          }, [view, wallet, darkMode]);

          useEffect(() => { 
            if (wallet && !isTestnet) { 
              loadTokenBalances(); 
            } 
          }, [wallet, chain, isTestnet]);

          useEffect(() => { 
            if (wallet) { 
              refreshBalance(); 
            } 
          }, [chain, isTestnet]);

          const copyToClipboard = (text) => { 
            navigator.clipboard.writeText(text); 
            showMsg('‚úÖ Copied!'); 
            celebrate();
          };

          const getUsdValue = () => { 
            if (!wallet || !prices[chains[chain].symbol]) return '0.00';
            return (parseFloat(wallet.balance) * prices[chains[chain].symbol]).toFixed(2); 
          };

          const nextIntroSlide = () => { 
            if (introStep < introSlides.length - 1) { 
              setIntroStep(introStep + 1); 
            } else { 
              setView('create'); 
            } 
          };

          const skipIntro = () => { 
            setView('create'); 
          };

          // Combine default and custom networks
          const allChains = { ...chains, ...customNetworks.reduce((acc, net) => ({ ...acc, [net.id]: net }), {}) };

          return (
            <div className={`min-h-screen ${darkMode ? 'dark' : ''}`}>
              <div className="animated-gradient min-h-screen p-4 md:p-8">
                
                {message && (
                  <div className="fixed top-4 right-4 z-50 glass-card rounded-2xl p-4 shadow-2xl fade-in max-w-md">
                    <p className="font-semibold">{message}</p>
                  </div>
                )}

                <div className="fixed top-4 left-4 z-40 flex space-x-2">
                  <button onClick={() => setDarkMode(!darkMode)} className="glass-card p-4 rounded-2xl hover-glow text-2xl">
                    {darkMode ? '‚òÄÔ∏è' : 'üåô'}
                  </button>
                  
                  {wallet && (
                    <button onClick={() => setShowNotifications(!showNotifications)} className="glass-card p-4 rounded-2xl hover-glow text-2xl relative">
                      üîî
                      {notifications.filter(n => !n.read).length > 0 && (
                        <span className="notification-badge">{notifications.filter(n => !n.read).length}</span>
                      )}
                    </button>
                  )}
                </div>

                {showNotifications && (
                  <div className="fixed top-20 left-4 z-50 glass-card rounded-2xl p-4 w-80 max-h-96 overflow-y-auto">
                    <div className="flex justify-between items-center mb-4">
                      <h3 className="font-bold text-lg">Notifications</h3>
                      <button onClick={() => setShowNotifications(false)} className="text-2xl">‚úï</button>
                    </div>
                    {notifications.length === 0 ? (
                      <p className="text-center text-gray-500 py-4">No notifications</p>
                    ) : (
                      <div className="space-y-2">
                        {notifications.map(notif => (
                          <div key={notif.id} className="p-3 bg-gray-50 dark:bg-gray-800 rounded-xl">
                            <div className="flex items-start space-x-2">
                              <span className="text-2xl">{notif.icon}</span>
                              <div className="flex-1">
                                <div className="font-semibold text-sm">{notif.title}</div>
                                <div className="text-xs text-gray-600 dark:text-gray-400">{notif.message}</div>
                                <div className="text-xs text-gray-500 mt-1">{notif.time}</div>
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                )}

                <div className="max-w-4xl mx-auto">
                  
                  {view === 'intro' && (
                    <div className="space-y-8 fade-in">
                      <div className="text-center py-12">
                        <h1 className="text-6xl md:text-8xl font-black gradient-text mb-4">BaintWallet</h1>
                        <p className="text-xl text-white/80 font-semibold">100% Free Multi-Chain Crypto Wallet</p>
                        <p className="text-sm text-white/60 mt-2">15+ Blockchains ‚Ä¢ Zero Fees on Sends ‚Ä¢ Your Keys, Your Crypto</p>
                      </div>

                      <div className={`glass-card rounded-3xl p-12 text-center hover-lift bg-gradient-to-br ${introSlides[introStep].gradient}`}>
                        <div className="text-8xl mb-6 float-animation">{introSlides[introStep].icon}</div>
                        <h2 className="text-4xl font-black mb-4 text-white">{introSlides[introStep].title}</h2>
                        <p className="text-xl text-white/90 font-medium">{introSlides[introStep].description}</p>
                      </div>

                      <div className="flex justify-center space-x-3 mb-8">
                        {introSlides.map((_, i) => (
                          <div key={i} className={`dot ${i === introStep ? 'dot-active' : ''}`}></div>
                        ))}
                      </div>

                      <div className="flex space-x-4">
                        <button onClick={skipIntro} className="flex-1 py-4 glass-card rounded-2xl font-bold text-lg hover-lift">
                          Skip
                        </button>
                        <button onClick={nextIntroSlide} className="flex-1 py-4 premium-button text-white rounded-2xl font-bold text-lg">
                          {introStep === introSlides.length - 1 ? 'Get Started' : 'Next'}
                        </button>
                      </div>
                    </div>
                  )}

                  {view === 'create' && (
                    <div className="space-y-6 fade-in">
                      <div className="text-center mb-8">
                        <h2 className="text-5xl font-black gradient-text mb-4">Choose Option</h2>
                        <p className="text-white/80 text-lg font-semibold">Create new wallet or import existing</p>
                        <div className="mt-4 inline-block glass-card px-6 py-3 rounded-full">
                          <span className="text-green-400 font-bold">‚úÖ 100% FREE</span>
                          <span className="text-white/80 ml-2">‚Ä¢ No Hidden Fees ‚Ä¢ No Signup Required</span>
                        </div>
                      </div>

                      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <button onClick={createWallet} disabled={loading} className="glass-card rounded-3xl p-12 hover-lift text-center group disabled:opacity-50">
                          <div className="text-7xl mb-6 group-hover:scale-110 transition-transform">‚ú®</div>
                          <h3 className="text-3xl font-black mb-3">Create Wallet</h3>
                          <p className="text-gray-600 dark:text-gray-400 font-medium">Generate new wallet</p>
                          {loading && <div className="mt-4 spinner inline-block text-3xl">‚è≥</div>}
                        </button>

                        <button onClick={() => setView('import')} className="glass-card rounded-3xl p-12 hover-lift text-center group">
                          <div className="text-7xl mb-6 group-hover:scale-110 transition-transform">üì•</div>
                          <h3 className="text-3xl font-black mb-3">Import Wallet</h3>
                          <p className="text-gray-600 dark:text-gray-400 font-medium">Use seed phrase</p>
                        </button>
                      </div>

                      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        {[
                          {icon:'üîí',title:'Military Security',desc:'Keys stay on device'},
                          {icon:'‚ö°',title:'15+ Chains',desc:'Multi-chain support'},
                          {icon:'üí∞',title:'100% FREE Sends',desc:'Zero platform fees'},
                          {icon:'üîµ',title:'Circle Arc Ready',desc:'First Arc wallet'},
                          {icon:'üîó',title:'WalletConnect',desc:'Connect to DApps'},
                          {icon:'üåê',title:'DApp Browser',desc:'Built-in browser'}
                        ].map((f,i)=>(
                          <div key={i} className="glass-card rounded-2xl p-6 hover-lift">
                            <div className="text-3xl mb-3">{f.icon}</div>
                            <h3 className="font-bold text-lg mb-2">{f.title}</h3>
                            <p className="text-sm text-gray-600 dark:text-gray-400">{f.desc}</p>
                          </div>
                        ))}
                      </div>
                    </div>
                  )}

                  {view === 'import' && (
                    <div className="space-y-6 fade-in">
                      <div className="glass-card rounded-3xl p-8">
                        <div className="flex items-center mb-6">
                          <button onClick={() => setView('create')} className="mr-4 p-2 bg-gray-100 dark:bg-gray-800 rounded-lg hover-glow">‚Üê Back</button>
                          <h2 className="text-2xl font-bold">Import Wallet</h2>
                        </div>
                        <div className="space-y-4">
                          <div>
                            <label className="block text-sm font-semibold mb-2">Seed Phrase (12 or 24 words)</label>
                            <textarea value={seedInput} onChange={(e) => setSeedInput(e.target.value)} placeholder="word1 word2 word3..." rows="4" className="w-full p-4 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:border-purple-500 focus:outline-none font-mono text-sm resize-none" />
                            <p className="text-xs text-gray-500 mt-2">‚ö†Ô∏è Never share your seed phrase with anyone!</p>
                          </div>
                          <button onClick={importWallet} disabled={loading || !seedInput.trim()} className="w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl font-bold text-lg hover-lift disabled:opacity-50">
                            {loading ? '‚è≥ Importing...' : 'üì• Import Wallet'}
                          </button>
                        </div>
                      </div>
                    </div>
                  )}

{view === 'wallet' && wallet && (
                    <div className="space-y-6 fade-in">
                      <div className={`glass-card rounded-3xl p-10 bg-gradient-to-br ${chains[chain].color} text-white hover-lift relative overflow-hidden shadow-2xl`}>
                        <div className="flex justify-between items-start mb-8 relative z-10">
                          <div>
                            <p className="text-sm opacity-75 mb-2 font-semibold uppercase">Total Balance</p>
                            <h2 className="text-6xl font-black mb-3">{countingBalance.toFixed(4)}</h2>
                            <div className="flex items-center space-x-2">
                              <span className="text-3xl font-bold">{chains[chain].symbol}</span>
                              <span className="text-lg opacity-75">‚Ä¢</span>
                              <span className="text-2xl font-semibold">${getUsdValue()}</span>
                            </div>
                          </div>
                          <div className="text-right">
                            <div className="text-7xl mb-3 float-animation">{chains[chain].icon}</div>
                            <div className="text-base font-bold">{chains[chain].name}</div>
                            <div className="text-xs opacity-75 mt-1">{isTestnet ? 'üß™ Testnet' : 'üåê Mainnet'}</div>
                          </div>
                        </div>
                        <div className="flex items-center justify-between pt-6 border-t-2 border-white/30 relative z-10"><div className="flex items-center space-x-3">
                            <div className={`w-3 h-3 rounded-full ${isTestnet ? 'bg-yellow-400' : 'bg-green-400'} animate-pulse`}></div>
                            <span className="font-semibold text-sm">Connected</span>
                          </div>
                          <button onClick={refreshBalance} disabled={loading} className="px-6 py-3 bg-white/20 rounded-xl hover:bg-white/30 transition-all font-semibold flex items-center space-x-2 hover-lift">
                            <span className={loading ? 'spinner inline-block' : ''}>üîÑ</span>
                            <span>Refresh</span>
                          </button>
                        </div>
                      </div>

                      <div className="glass-card rounded-3xl p-6 hover-lift">
                        <div className="flex items-center justify-between">
                          <div className="flex-1">
                            <p className="text-sm text-gray-600 dark:text-gray-400 mb-1 font-semibold">Address</p>
                            <p className="font-mono text-sm break-all">{wallet.address}</p>
                          </div>
                          <button onClick={() => copyToClipboard(wallet.address)} className="ml-4 p-3 bg-purple-100 dark:bg-purple-900 rounded-xl hover-glow">üìã</button>
                        </div>
                      </div>

                      <div className="glass-card rounded-3xl p-6">
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          <div>
                            <label className="block text-sm font-semibold mb-2">Chain ({Object.keys(allChains).length} Available)</label>
                            <select value={chain} onChange={(e) => setChain(e.target.value)} className="w-full p-3 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:border-purple-500 focus:outline-none">
                              {Object.entries(allChains).map(([key, c]) => (
                                <option key={key} value={key}>{c.icon} {c.name} {c.isCustom ? '(Custom)' : ''}</option>
                              ))}
                            </select>
                          </div>
                          <div>
                            <label className="block text-sm font-semibold mb-2">Network</label>
                            <div className="flex space-x-2">
                              <button onClick={() => setIsTestnet(true)} className={`flex-1 py-3 rounded-xl font-semibold transition-all ${isTestnet ? 'bg-gradient-to-r from-purple-600 to-pink-600 text-white' : 'bg-gray-200 dark:bg-gray-700'}`}>üß™ Test</button>
                              <button onClick={() => setIsTestnet(false)} className={`flex-1 py-3 rounded-xl font-semibold transition-all ${!isTestnet ? 'bg-gradient-to-r from-purple-600 to-pink-600 text-white' : 'bg-gray-200 dark:bg-gray-700'}`}>üåê Main</button>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <button onClick={() => setView('send')} className="glass-card rounded-2xl p-6 hover-lift text-center group">
                          <div className="text-4xl mb-2 group-hover:scale-110 transition-transform">üì§</div>
                          <div className="font-bold">Send</div>
                          <div className="text-xs text-green-500 mt-1">FREE</div>
                        </button>
                        <button onClick={() => setView('receive')} className="glass-card rounded-2xl p-6 hover-lift text-center group">
                          <div className="text-4xl mb-2 group-hover:scale-110 transition-transform">üì•</div>
                          <div className="font-bold">Receive</div>
                          <div className="text-xs text-gray-500 dark:text-gray-400 mt-1">QR Code</div>
                        </button>
                        <button onClick={() => setView('nfts')} className="glass-card rounded-2xl p-6 hover-lift text-center group">
                          <div className="text-4xl mb-2 group-hover:scale-110 transition-transform">üñºÔ∏è</div>
                          <div className="font-bold">NFTs</div>
                          <div className="text-xs text-gray-500 dark:text-gray-400 mt-1">Gallery</div>
                        </button>
                        <button onClick={() => setView('referral')} className="glass-card rounded-2xl p-6 hover-lift text-center group">
                          <div className="text-4xl mb-2 group-hover:scale-110 transition-transform">üéÅ</div>
                          <div className="font-bold">Referral</div>
                          <div className="text-xs text-purple-500 mt-1">Earn 25%</div>
                        </button>
                      </div>

                      <div className="grid grid-cols-2 gap-4">
                        <button onClick={() => setView('walletconnect')} className="glass-card rounded-2xl p-6 hover-lift text-center group">
                          <div className="text-4xl mb-2 group-hover:scale-110 transition-transform">üîó</div>
                          <div className="font-bold">WalletConnect</div>
                          <div className="text-xs text-gray-500 dark:text-gray-400 mt-1">DApps</div>
                        </button>
                        <button onClick={() => setShowDappBrowser(true)} className="glass-card rounded-2xl p-6 hover-lift text-center group">
                          <div className="text-4xl mb-2 group-hover:scale-110 transition-transform">üåê</div>
                          <div className="font-bold">Browser</div>
                          <div className="text-xs text-gray-500 dark:text-gray-400 mt-1">DApps</div>
                        </button>
                      </div>

                      <button onClick={() => setShowAddNetwork(true)} className="w-full glass-card rounded-2xl p-4 hover-lift text-center">
                        <span className="font-bold">‚ûï Add Custom Network</span>
                        <span className="text-green-500 ml-2 text-sm">(FREE)</span>
                      </button>

                      {!isTestnet && (
                        <div className="glass-card rounded-3xl p-8">
                          <div className="flex justify-between items-center mb-6">
                            <div className="flex items-center space-x-3">
                              <span className="text-3xl">ü™ô</span>
                              <h3 className="font-bold text-2xl">Tokens</h3>
                            </div>
                            <button onClick={loadTokenBalances} disabled={loadingTokens} className="px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl font-bold hover-lift disabled:opacity-50 shadow-lg">
                              <span className={loadingTokens ? 'spinner inline-block' : ''}>üîÑ</span> {loadingTokens ? 'Loading...' : 'Refresh'}
                            </button>
                          </div>
                          {tokens.length === 0 ? (
                            <div className="text-center py-12">
                              <div className="text-6xl mb-4">üí∞</div>
                              <p className="text-gray-500 dark:text-gray-400 font-medium">No tokens found</p>
                              <p className="text-sm text-gray-400 dark:text-gray-500 mt-2">Tokens will appear here when you have balance</p>
                            </div>
                          ) : (
                            <div className="space-y-3">
                              {tokens.map((token, i) => (
                                <div key={i} onClick={() => { setSelectedToken(token); setView('send-token'); }} className="glass-card p-6 rounded-2xl hover-lift cursor-pointer flex justify-between items-center">
                                  <div>
                                    <div className="font-bold text-lg">{token.symbol}</div>
                                    <div className="text-sm text-gray-500 dark:text-gray-400">{token.name}</div>
                                  </div>
                                  <div className="text-right">
                                    <div className="font-bold text-xl">{parseFloat(token.balance).toFixed(4)}</div>
                                    <div className="text-xs text-green-500">FREE sends</div>
                                  </div>
                                </div>
                              ))}
                            </div>
                          )}
                        </div>
                      )}

                      {txs.length > 0 && (
                        <div className="glass-card rounded-3xl p-8">
                          <h3 className="font-bold text-2xl mb-6 flex items-center">
                            <span className="text-3xl mr-3">üìú</span>
                            Recent Transactions
                          </h3>
                          <div className="space-y-3">
                            {txs.slice(0, 5).map((tx, i) => (
                              <div key={i} className="glass-card p-4 rounded-xl flex justify-between items-center hover-lift">
                                <div className="flex-1">
                                  <div className="font-semibold">{tx.type === 'send' ? 'üì§ Sent' : 'ü™ô Token Sent'} {tx.amount} {tx.symbol}</div>
                                  <div className="text-xs text-gray-500 dark:text-gray-400 mt-1">{tx.time}</div>
                                  <div className="text-xs text-green-500 mt-1">Platform Fee: FREE</div>
                                </div>
                                <div className="flex items-center space-x-3">
                                  <span className={`px-3 py-1 rounded-lg text-xs font-bold ${tx.status === 'confirmed' ? 'bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300' : 'bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300'}`}>
                                    {tx.status === 'confirmed' ? '‚úÖ Confirmed' : '‚è≥ Pending'}
                                  </span>
                                  <button onClick={() => generateReceipt(tx)} className="p-2 bg-blue-100 dark:bg-blue-900 rounded-lg hover-glow">üìÑ</button>
                                  <a href={`${getExplorer()}/tx/${tx.hash}`} target="_blank" rel="noopener noreferrer" className="p-2 bg-purple-100 dark:bg-purple-900 rounded-lg hover-glow">üîç</a>
                                </div>
                              </div>
                            ))}
                          </div>
                        </div>
                      )}

                      <div className="glass-card rounded-3xl p-8">
                        <h3 className="font-bold text-2xl mb-6 flex items-center">
                          <span className="text-3xl mr-3">üîê</span>
                          Security
                        </h3>
                        <div className="space-y-4">
                          <button onClick={() => setShowSeed(!showSeed)} className="w-full py-4 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-xl font-bold text-lg hover-lift">
                            {showSeed ? 'üôà Hide' : 'üëÅÔ∏è Show'} Seed Phrase
                          </button>
                          {showSeed && (
                            <div className="p-6 bg-red-50 dark:bg-red-900 dark:bg-opacity-20 rounded-xl border-2 border-red-300 dark:border-red-700">
                              <p className="font-mono text-sm break-all mb-4">{wallet.mnemonic}</p>
                              <button onClick={() => copyToClipboard(wallet.mnemonic)} className="w-full py-3 bg-red-500 text-white rounded-xl font-bold hover-lift">üìã Copy Seed</button>
                              <p className="text-xs text-red-600 dark:text-red-400 mt-4 font-semibold">‚ö†Ô∏è Never share this with anyone! Anyone with this phrase can access your funds.</p>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                  )}

                  {view === 'send' && wallet && (
                    <div className="space-y-6 fade-in">
                      <div className="glass-card rounded-3xl p-8">
                        <div className="flex items-center mb-6">
                          <button onClick={() => setView('wallet')} className="mr-4 p-2 bg-gray-100 dark:bg-gray-800 rounded-lg hover-glow">‚Üê Back</button>
                          <h2 className="text-2xl font-bold">Send {chains[chain].symbol}</h2>
                          <span className="ml-auto bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 px-4 py-2 rounded-full font-bold text-sm">‚úÖ FREE</span>
                        </div>
                        <div className="space-y-4">
                          <div>
                            <label className="block text-sm font-semibold mb-2">Recipient Address</label>
                            <input type="text" value={sendTo} onChange={(e) => setSendTo(e.target.value)} placeholder="0x..." className="w-full p-4 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:border-purple-500 focus:outline-none font-mono text-sm" />
                          </div>
                          <div>
                            <label className="block text-sm font-semibold mb-2">Amount</label>
                            <div className="relative">
                              <input type="number" step="0.0001" value={sendAmount} onChange={(e) => setSendAmount(e.target.value)} placeholder="0.0" className="w-full p-4 pr-20 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:border-purple-500 focus:outline-none text-lg font-semibold" />
                              <div className="absolute right-4 top-1/2 transform -translate-y-1/2 font-semibold text-gray-500">{chains[chain].symbol}</div>
                            </div>
                            <button onClick={() => setSendAmount(wallet.balance)} className="mt-2 text-sm text-purple-600 hover:text-purple-800 font-semibold">Max: {parseFloat(wallet.balance).toFixed(6)}</button>
                          </div>
                          <div className="p-4 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-xl">
                            <div className="flex justify-between text-sm mb-2">
                              <span className="font-semibold">Network Fee:</span>
                              <span>~$2-5 (paid to miners)</span>
                            </div>
                            <div className="flex justify-between text-sm">
                              <span className="font-semibold text-green-600">Platform Fee:</span>
                              <span className="font-bold text-green-600">FREE ‚úÖ</span>
                            </div>
                          </div>
                          <button onClick={send} disabled={loading || !sendTo || !sendAmount} className="w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl font-bold text-lg hover-lift disabled:opacity-50">{loading ? '‚è≥ Sending...' : 'üöÄ Send (FREE)'}</button>
                        </div>
                      </div>
                    </div>
                  )}

                  {view === 'send-token' && selectedToken && (
                    <div className="space-y-6 fade-in">
                      <div className="glass-card rounded-3xl p-8">
                        <div className="flex items-center mb-6">
                          <button onClick={() => { setView('wallet'); setSelectedToken(null); }} className="mr-4 p-2 bg-gray-100 dark:bg-gray-800 rounded-lg hover-glow">‚Üê Back</button>
                          <h2 className="text-2xl font-bold">Send {selectedToken.symbol}</h2>
                          <span className="ml-auto bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 px-4 py-2 rounded-full font-bold text-sm">‚úÖ FREE</span>
                        </div>
                        <div className="p-4 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-xl mb-6">
                          <div className="text-sm text-gray-600 dark:text-gray-400 mb-1">Balance</div>
                          <div className="text-2xl font-bold">{parseFloat(selectedToken.balance).toFixed(4)} {selectedToken.symbol}</div>
                        </div>
                        <div className="space-y-4">
                          <div>
                            <label className="block text-sm font-semibold mb-2">Recipient</label>
                            <input type="text" value={sendTo} onChange={(e) => setSendTo(e.target.value)} placeholder="0x..." className="w-full p-4 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:border-purple-500 focus:outline-none font-mono text-sm" />
                          </div>
                          <div>
                            <label className="block text-sm font-semibold mb-2">Amount</label>
                            <div className="relative">
                              <input type="number" step="0.01" value={sendTokenAmount} onChange={(e) => setSendTokenAmount(e.target.value)} placeholder="0.0" className="w-full p-4 pr-24 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:border-purple-500 focus:outline-none text-lg font-semibold" />
                              <div className="absolute right-4 top-1/2 transform -translate-y-1/2 font-semibold text-gray-500">{selectedToken.symbol}</div>
                            </div>
                            <button onClick={() => setSendTokenAmount(selectedToken.balance)} className="mt-2 text-sm text-purple-600 hover:text-purple-800 font-semibold">Max: {parseFloat(selectedToken.balance).toFixed(6)}</button>
                          </div>
                          <button onClick={sendToken} disabled={loading || !sendTo || !sendTokenAmount} className="w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl font-bold text-lg hover-lift disabled:opacity-50">{loading ? '‚è≥ Sending...' : `üöÄ Send ${selectedToken.symbol} (FREE)`}</button>
                        </div>
                      </div>
                    </div>
                  )}

                  {view === 'receive' && wallet && (
                    <div className="space-y-6 fade-in">
                      <div className="glass-card rounded-3xl p-8">
                        <div className="flex items-center mb-6">
                          <button onClick={() => setView('wallet')} className="mr-4 p-2 bg-gray-100 dark:bg-gray-800 rounded-lg hover-glow">‚Üê Back</button>
                          <h2 className="text-2xl font-bold">Receive {chains[chain].symbol}</h2>
                        </div>
                        <div className="text-center">
                          <div className="inline-block p-6 bg-white dark:bg-gray-800 rounded-2xl mb-6 shadow-lg">
                            <div ref={qrRef}></div>
                          </div>
                          <p className="text-sm text-gray-600 dark:text-gray-400 mb-4 font-medium">Scan QR or copy address</p>
                          <div className="p-4 bg-gray-50 dark:bg-gray-800 rounded-xl font-mono text-sm break-all mb-4">{wallet.address}</div>
                          <button onClick={() => copyToClipboard(wallet.address)} className="w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl font-bold text-lg hover-lift">üìã Copy Address</button>
                          <div className="mt-6 p-4 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded-xl">
                            <p className="text-sm font-semibold text-yellow-800 dark:text-yellow-200">‚ö†Ô∏è Only send {chains[chain].symbol} on {chains[chain].name} {isTestnet ? 'Testnet' : 'Mainnet'}!</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  )}

                  {view === 'nfts' && (
                    <div className="space-y-6 fade-in">
                      <div className="glass-card rounded-3xl p-8">
                        <div className="flex items-center justify-between mb-6">
                          <div className="flex items-center">
                            <button onClick={() => setView('wallet')} className="mr-4 p-2 bg-gray-100 dark:bg-gray-800 rounded-lg hover-glow">‚Üê Back</button>
                            <h2 className="text-2xl font-bold flex items-center">
                              <span className="text-3xl mr-3">üñºÔ∏è</span>
                              NFT Gallery
                            </h2>
                          </div>
                          <button onClick={loadNFTs} disabled={loadingNFTs} className="px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl font-bold hover-lift disabled:opacity-50">
                            <span className={loadingNFTs ? 'spinner inline-block' : ''}>üîÑ</span> {loadingNFTs ? 'Loading...' : 'Load NFTs'}
                          </button>
                        </div>

                        {isTestnet && (
                          <div className="p-4 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded-xl mb-6">
                            <p className="text-sm font-semibold text-yellow-800 dark:text-yellow-200">‚ö†Ô∏è NFTs only available on Mainnet. Switch to mainnet to view your NFTs.</p>
                          </div>
                        )}

                        {nfts.length === 0 && !loadingNFTs ? (
                          <div className="text-center py-12">
                            <div className="text-6xl mb-4">üñºÔ∏è</div>
                            <p className="text-gray-500 dark:text-gray-400 font-medium">No NFTs found</p>
                            <p className="text-sm text-gray-400 dark:text-gray-500 mt-2">Your NFTs will appear here</p>
                            <button onClick={loadNFTs} className="mt-6 px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl font-bold hover-lift">
                              üîç Search for NFTs
                            </button>
                          </div>
                        ) : (
                          <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                            {nfts.map((nft, i) => (
                              <div key={i} onClick={() => setSelectedNFT(nft)} className="glass-card rounded-xl p-4 hover-lift cursor-pointer">
                                {nft.image ? (
                                  <img src={nft.image} alt={nft.name} className="w-full aspect-square object-cover rounded-lg mb-2" onError={(e) => { e.target.src = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200"%3E%3Crect fill="%23ddd" width="200" height="200"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="%23999"%3ENFT%3C/text%3E%3C/svg%3E'; }} />
                                ) : (
                                  <div className="w-full aspect-square bg-gray-200 dark:bg-gray-700 rounded-lg mb-2 flex items-center justify-center text-4xl">üñºÔ∏è</div>
                                )}
                                <div className="font-bold text-sm truncate">{nft.name}</div>
                                <div className="text-xs text-gray-500 truncate">{nft.collection}</div>
                              </div>
                            ))}
                          </div>
                        )}
                      </div>

                      {selectedNFT && (
                        <div className="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4" onClick={() => setSelectedNFT(null)}>
                          <div className="glass-card rounded-3xl max-w-2xl w-full p-8" onClick={(e) => e.stopPropagation()}>
                            <div className="flex justify-between items-start mb-6">
                              <h3 className="text-2xl font-bold">{selectedNFT.name}</h3>
                              <button onClick={() => setSelectedNFT(null)} className="text-2xl p-2 hover-glow">‚úï</button>
                            </div>
                            
                            <div className="mb-6">
                              {selectedNFT.image ? (
                                <img src={selectedNFT.image} alt={selectedNFT.name} className="w-full max-h-96 object-contain rounded-2xl" />
                              ) : (
                                <div className="w-full h-96 bg-gray-200 dark:bg-gray-700 rounded-2xl flex items-center justify-center text-6xl">üñºÔ∏è</div>
                              )}
                            </div>

                            <div className="space-y-3 mb-6">
                              <div>
                                <div className="text-sm text-gray-500">Collection</div>
                                <div className="font-semibold">{selectedNFT.collection}</div>
                              </div>
                              <div>
                                <div className="text-sm text-gray-500">Token ID</div>
                                <div className="font-mono text-sm">{selectedNFT.tokenId}</div>
                              </div>
                              {selectedNFT.description && (
                                <div>
                                  <div className="text-sm text-gray-500">Description</div>
                                  <div className="text-sm">{selectedNFT.description}</div>
                                </div>
                              )}
                            </div>

                            <div className="p-4 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-xl mb-4">
                              <div className="flex justify-between text-sm">
                                <span className="font-semibold">NFT Transfer Fee:</span>
                                <span className="font-bold text-purple-600">${NFT_TRANSFER_FEE}</span>
                              </div>
                              <div className="text-xs text-gray-500 mt-1">Plus network gas fees</div>
                            </div>

                            <div className="space-y-3">
                              <input type="text" placeholder="Recipient address (0x...)" value={sendTo} onChange={(e) => setSendTo(e.target.value)} className="w-full p-4 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:border-purple-500 focus:outline-none font-mono text-sm" />
                              <button onClick={() => sendNFT(selectedNFT, sendTo)} disabled={loading || !sendTo} className="w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl font-bold text-lg hover-lift disabled:opacity-50">
                                {loading ? '‚è≥ Sending NFT...' : `üì§ Send NFT ($${NFT_TRANSFER_FEE} fee)`}
                              </button>
                            </div>
                          </div>
                        </div>
                      )}
                    </div>
                  )}

                  {view === 'referral' && (
                    <div className="space-y-6 fade-in">
                      <div className="glass-card rounded-3xl p-8">
                        <div className="flex items-center mb-6">
                          <button onClick={() => setView('wallet')} className="mr-4 p-2 bg-gray-100 dark:bg-gray-800 rounded-lg hover-glow">‚Üê Back</button>
                          <h2 className="text-2xl font-bold flex items-center">
                            <span className="text-3xl mr-3">üéÅ</span>
                            Referral Program
                          </h2>
                        </div>

                        <div className="p-6 bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl text-white mb-6">
                          <h3 className="text-2xl font-bold mb-2">Earn 25% Commission!</h3>
                          <p className="text-white/90">Refer friends and earn 25% of their NFT transfer fees. They get 10% discount too!</p>
                        </div>

                        <div className="space-y-4 mb-6">
                          <div>
                            <label className="block text-sm font-semibold mb-2">Your Referral Code</label>
                            <div className="flex items-center space-x-2">
                              <input type="text" value={referralCode} readOnly className="flex-1 p-4 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 font-mono font-bold text-lg" />
                              <button onClick={() => copyToClipboard(referralCode)} className="px-6 py-4 bg-purple-500 text-white rounded-xl font-bold hover-lift">üìã</button>
                            </div>
                          </div>

                          <div>
                            <label className="block text-sm font-semibold mb-2">Your Referral Link</label>
                            <div className="flex items-center space-x-2">
                              <input type="text" value={`${window.location.origin}?ref=${referralCode}`} readOnly className="flex-1 p-4 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 font-mono text-sm" />
                              <button onClick={() => copyToClipboard(`${window.location.origin}?ref=${referralCode}`)} className="px-6 py-4 bg-purple-500 text-white rounded-xl font-bold hover-lift">üìã</button>
                            </div>
                          </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                          <div className="glass-card p-6 rounded-2xl text-center">
                            <div className="text-3xl mb-2">üë•</div>
                            <div className="text-3xl font-bold mb-1">{referralStats.referrals}</div>
                            <div className="text-sm text-gray-500">Total Referrals</div>
                          </div>
                          <div className="glass-card p-6 rounded-2xl text-center">
                            <div className="text-3xl mb-2">üí∞</div>
                            <div className="text-3xl font-bold mb-1">${referralStats.earnings.toFixed(2)}</div>
                            <div className="text-sm text-gray-500">Total Earnings</div>
                          </div>
                          <div className="glass-card p-6 rounded-2xl text-center">
                            <div className="text-3xl mb-2">üéØ</div>
                            <div className="text-3xl font-bold mb-1">25%</div>
                            <div className="text-sm text-gray-500">Commission Rate</div>
                          </div>
                        </div>

                        <div className="p-6 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-xl">
                          <h4 className="font-bold mb-3">üìä How It Works:</h4>
                          <ol className="space-y-2 text-sm">
                            <li className="flex items-start">
                              <span className="font-bold mr-2">1.</span>
                              <span>Share your referral link with friends</span>
                            </li>
                            <li className="flex items-start">
                              <span className="font-bold mr-2">2.</span>
                              <span>They sign up using your link and get 10% discount on NFT fees</span>
                            </li>
                            <li className="flex items-start">
                              <span className="font-bold mr-2">3.</span>
                              <span>You earn 25% commission on their NFT transfer fees</span>
                            </li>
                            <li className="flex items-start">
                              <span className="font-bold mr-2">4.</span>
                              <span>Earnings are automatically tracked and credited</span>
                            </li>
                          </ol>
                        </div>
                      </div>
                    </div>
                  )}

                  {view === 'walletconnect' && wallet && (
                    <div className="space-y-6 fade-in">
                      <div className="glass-card rounded-3xl p-8">
                        <div className="flex items-center mb-6">
                          <button onClick={() => setView('wallet')} className="mr-4 p-2 bg-gray-100 dark:bg-gray-800 rounded-lg hover-glow">‚Üê Back</button>
                          <h2 className="text-2xl font-bold">WalletConnect</h2>
                        </div>

                        {!wcConnected ? (
                          <div className="space-y-6">
                            <div className="text-center py-8">
                              <div className="text-6xl mb-4">üîó</div>
                              <h3 className="text-xl font-bold mb-2">Connect to DApps</h3>
                              <p className="text-gray-600 dark:text-gray-400">Paste WalletConnect URI to connect</p>
                            </div>
                            <div>
                              <label className="block text-sm font-semibold mb-2">WalletConnect URI</label>
                              <textarea value={wcUri} onChange={(e) => setWcUri(e.target.value)} placeholder="wc:..." rows="3" className="w-full p-4 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:border-purple-500 focus:outline-none font-mono text-sm resize-none" />
                            </div>
                            <button onClick={connectWalletConnect} disabled={!wcUri.trim()} className="w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl font-bold text-lg hover-lift disabled:opacity-50">üîó Connect</button>
                            
                            <div className="p-4 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-xl">
                              <p className="text-sm font-semibold text-blue-800 dark:text-blue-200 mb-2">üí° How to use:</p>
                              <ol className="text-sm text-blue-700 dark:text-blue-300 space-y-1 ml-4">
                                <li>1. Open a DApp (Uniswap, OpenSea, etc.)</li>
                                <li>2. Click "Connect Wallet"</li>
                                <li>3. Select "WalletConnect"</li>
                                <li>4. Copy the URI and paste here</li>
                              </ol>
                            </div>

                            <div className="grid grid-cols-2 gap-4">
                              <a href="https://app.uniswap.org" target="_blank" rel="noopener noreferrer" className="glass-card p-4 rounded-xl text-center hover-lift">
                                <div className="text-3xl mb-2">ü¶Ñ</div>
                                <div className="font-semibold text-sm">Uniswap</div>
                              </a>
                              <a href="https://app.aave.com" target="_blank" rel="noopener noreferrer" className="glass-card p-4 rounded-xl text-center hover-lift">
                                <div className="text-3xl mb-2">üëª</div>
                                <div className="font-semibold text-sm">Aave</div>
                              </a>
                            </div>
                          </div>
                        ) : (
                          <div className="space-y-6">
                            <div className="text-center py-8">
                              <div className="text-6xl mb-4">‚úÖ</div>
                              <h3 className="text-xl font-bold mb-2 text-green-600">Connected!</h3>
                              <p className="text-gray-600 dark:text-gray-400">Session active</p>
                            </div>
                            
                            <div className="p-4 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-xl">
                              <p className="text-sm text-green-800 dark:text-green-200">Your wallet is connected. You can now interact with the DApp.</p>
                            </div>

                            <button onClick={disconnectWalletConnect} className="w-full py-4 bg-red-500 text-white rounded-xl font-bold text-lg hover-lift">üîå Disconnect</button>
                          </div>
                        )}
                      </div>
                    </div>
                  )}
                </div>

                {showDappBrowser && (
                  <div className="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                    <div className="glass-card rounded-3xl w-full max-w-6xl h-[90vh] flex flex-col">
                      <div className="flex items-center justify-between p-6 border-b-2 border-gray-200 dark:border-gray-700">
                        <div className="flex items-center space-x-4 flex-1">
                          <button onClick={() => setShowDappBrowser(false)} className="p-2 bg-red-500 text-white rounded-lg hover-glow">‚úï</button>
                          <input type="url" value={dappUrl} onChange={(e) => setDappUrl(e.target.value)} placeholder="Enter DApp URL..." className="flex-1 p-3 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:border-purple-500 focus:outline-none font-mono text-sm" />
                          <button onClick={() => {}} className="px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl font-bold hover-lift">Go</button>
                        </div>
                      </div>
                      
                      <div className="flex-1 p-4">
                        <div className="h-full bg-white dark:bg-gray-900 rounded-2xl overflow-hidden relative">
                          <iframe src={dappUrl} className="w-full h-full border-0" sandbox="allow-scripts allow-same-origin allow-forms allow-popups" title="DApp Browser" />
                          
                          <div className="absolute bottom-4 right-4 glass-card p-3 rounded-xl">
                            <div className="text-xs font-semibold text-gray-600 dark:text-gray-400">
                              Connected: {wallet?.address?.slice(0, 6)}...{wallet?.address?.slice(-4)}
                            </div>
                            <div className="text-xs text-gray-500 mt-1">{chains[chain].name}</div>
                          </div>
                        </div>
                      </div>

                      <div className="p-4 border-t-2 border-gray-200 dark:border-gray-700">
                        <div className="flex items-center justify-between">
                          <div className="flex space-x-2">
                            {[
                              { name: 'Uniswap', url: 'https://app.uniswap.org', icon: 'ü¶Ñ' },
                              { name: 'Aave', url: 'https://app.aave.com', icon: 'üëª' },
                              { name: 'OpenSea', url: 'https://opensea.io', icon: 'üåä' },
                              { name: 'Curve', url: 'https://curve.fi', icon: 'üìà' }
                            ].map((dapp, i) => (
                              <button key={i} onClick={() => setDappUrl(dapp.url)} className="glass-card px-4 py-2 rounded-xl hover-lift flex items-center space-x-2">
                                <span>{dapp.icon}</span>
                                <span className="text-sm font-semibold">{dapp.name}</span>
                              </button>
                            ))}
                          </div>
                          <div className="text-sm text-gray-500">
                            <span className="font-semibold text-yellow-600">‚ö†Ô∏è</span> Beta Feature
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                )}

                {showAddNetwork && (
                  <div className="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                    <div className="glass-card rounded-3xl max-w-2xl w-full p-8">
                      <div className="flex justify-between items-center mb-6">
                        <h3 className="text-2xl font-bold">‚ûï Add Custom Network</h3>
                        <button onClick={() => setShowAddNetwork(false)} className="text-2xl p-2 hover-glow">‚úï</button>
                      </div>

                      <div className="p-4 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-xl mb-6">
                        <p className="text-sm font-semibold text-green-800 dark:text-green-200">‚úÖ Custom networks are FREE!</p>
                      </div>

                      <div className="space-y-4">
                        <div>
                          <label className="block text-sm font-semibold mb-2">Network Name *</label>
                          <input type="text" value={newNetwork.name} onChange={(e) => setNewNetwork({...newNetwork, name: e.target.value})} placeholder="My Custom Network" className="w-full p-4 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:border-purple-500 focus:outline-none" />
                        </div>

                        <div>
                          <label className="block text-sm font-semibold mb-2">RPC URL *</label>
                          <input type="url" value={newNetwork.rpc} onChange={(e) => setNewNetwork({...newNetwork, rpc: e.target.value})} placeholder="https://rpc.example.com" className="w-full p-4 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:border-purple-500 focus:outline-none font-mono text-sm" />
                        </div>

                        <div>
                          <label className="block text-sm font-semibold mb-2">Chain ID *</label>
                          <input type="number" value={newNetwork.chainId} onChange={(e) => setNewNetwork({...newNetwork, chainId: e.target.value})} placeholder="1234" className="w-full p-4 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:border-purple-500 focus:outline-none" />
                        </div>

                        <div>
                          <label className="block text-sm font-semibold mb-2">Currency Symbol *</label>
                          <input type="text" value={newNetwork.symbol} onChange={(e) => setNewNetwork({...newNetwork, symbol: e.target.value})} placeholder="ETH" className="w-full p-4 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:border-purple-500 focus:outline-none" />
                        </div>

                        <div>
                          <label className="block text-sm font-semibold mb-2">Block Explorer URL (Optional)</label>
                          <input type="url" value={newNetwork.explorer} onChange={(e) => setNewNetwork({...newNetwork, explorer: e.target.value})} placeholder="https://explorer.example.com" className="w-full p-4 rounded-xl border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:border-purple-500 focus:outline-none font-mono text-sm" />
                        </div>

                        <div className="flex space-x-4">
                          <button onClick={() => setShowAddNetwork(false)} className="flex-1 py-4 bg-gray-200 dark:bg-gray-700 rounded-xl font-bold hover-lift">Cancel</button>
                          <button onClick={addCustomNetwork} disabled={loading} className="flex-1 py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl font-bold hover-lift disabled:opacity-50">
                            {loading ? '‚è≥ Adding...' : '‚úÖ Add Network (FREE)'}
                          </button>
                        </div>
                      </div>

                      {customNetworks.length > 0 && (
                        <div className="mt-6">
                          <h4 className="font-bold mb-3">Your Custom Networks:</h4>
                          <div className="space-y-2">
                            {customNetworks.map(net => (
                              <div key={net.id} className="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-xl">
                                <div>
                                  <div className="font-semibold">{net.name}</div>
                                  <div className="text-xs text-gray-500">Chain ID: {net.testnet.chainId}</div>
                                </div>
                                <button onClick={() => removeCustomNetwork(net.id)} className="px-4 py-2 bg-red-500 text-white rounded-lg font-bold hover-lift text-sm">üóëÔ∏è Remove</button>
                              </div>
                            ))}
                          </div>
                        </div>
                      )}
                    </div>
                  </div>
                )}

                {view !== 'intro' && (
                  <div className="max-w-4xl mx-auto mt-16 text-center">
                    <div className="glass-card rounded-2xl p-6 mb-6">
                      <div className="flex items-center justify-center space-x-8 text-white/80">
                        <div className="flex items-center space-x-2">
                          <span className="text-2xl">üîí</span>
                          <span className="font-semibold">Secure</span>
                        </div>
                        <div className="w-px h-8 bg-white/20"></div>
                        <div className="flex items-center space-x-2">
                          <span className="text-2xl">‚ö°</span>
                          <span className="font-semibold">100% Free</span>
                        </div>
                        <div className="w-px h-8 bg-white/20"></div>
                        <div className="flex items-center space-x-2">
                          <span className="text-2xl">üåê</span>
                          <span className="font-semibold">15+ Chains</span>
                        </div>
                      </div>
                    </div>
                    <p className="text-white/70 text-sm font-medium">Built with ‚ù§Ô∏è for the Web3 future</p>
                    <p className="text-white/50 text-xs mt-2">Your keys, your crypto. Always.</p>
                  </div>
                )}
              </div>
            </div>
          );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html
